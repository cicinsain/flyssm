\hypertarget{lsa_8c}{
\section{lam/lsa.c File Reference}
\label{lsa_8c}\index{lam/lsa.c@{lam/lsa.c}}
}
{\ttfamily \#include $<$math.h$>$}\par
{\ttfamily \#include $<$float.h$>$}\par
{\ttfamily \#include $<$limits.h$>$}\par
{\ttfamily \#include $<$stdio.h$>$}\par
{\ttfamily \#include $<$stdlib.h$>$}\par
{\ttfamily \#include $<$string.h$>$}\par
{\ttfamily \#include $<$sys/types.h$>$}\par
{\ttfamily \#include $<$sys/times.h$>$}\par
{\ttfamily \#include $<$time.h$>$}\par
{\ttfamily \#include $<$unistd.h$>$}\par
{\ttfamily \#include $<$sa.h$>$}\par
{\ttfamily \#include $<$error.h$>$}\par
{\ttfamily \#include $<$random.h$>$}\par
{\ttfamily \#include $<$distributions.h$>$}\par
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{lsa_8c_a3c04138a5bfe5d72780bb7e82a18e627}{main} (int argc, char $\ast$$\ast$argv)
\item 
void \hyperlink{lsa_8c_a98f8ef9313691be2823b678050cf41ae}{Initialize} (int argc, char $\ast$$\ast$argv)
\item 
void \hyperlink{lsa_8c_a29ace73bf86acc89685ac790663260be}{InitFilenames} (\hyperlink{structFiles}{Files} $\ast$files)
\item 
void \hyperlink{lsa_8c_ac7b75e6e07185445d2cca5b3531c82b1}{InitialLoop} (void)
\item 
void \hyperlink{lsa_8c_ae10c4c8f9a418b3936a83312162c8894}{InitializeParameter} (void)
\item 
void \hyperlink{lsa_8c_a9c04d1f899ab7d94678c92af91aa5d8e}{InitializeWeights} (void)
\item 
void \hyperlink{lsa_8c_a3d44ba75fca31cf103092e6b7a604dcf}{Loop} (void)
\item 
void \hyperlink{lsa_8c_afa56aa04d2b65406905685c3a86c37d9}{UpdateS} (void)
\item 
void \hyperlink{lsa_8c_a6fbfe227a3d23a2cc0fde42be52e9dd1}{UpdateStats} (int i)
\item 
void \hyperlink{lsa_8c_ab19b9c7ff28b4c66da90a3557eff33ea}{UpdateParameter} (void)
\item 
int \hyperlink{lsa_8c_af1f7f727fc1eb8fadaf6771b9c16e977}{Frozen} (void)
\item 
void \hyperlink{lsa_8c_ae56852702f23eab04eecd25bf09406e5}{FixTLoop} (void)
\item 
void \hyperlink{lsa_8c_afcd9faeb0e89612337adc262aa8ada76}{GetEquil} (double $\ast$equil\_\-var)
\item 
void \hyperlink{lsa_8c_a58d451ed22a1cef60419ddd598695004}{SetEquilibrate} (\hyperlink{structChuParam}{ChuParam} ep)
\item 
void \hyperlink{lsa_8c_ad28f23592af10fe367b042d101d20d2c}{InitLandscape} (int value, char $\ast$file)
\item 
double $\ast$ \hyperlink{lsa_8c_a97015221283e0ba21a0678b889fa9d85}{GetLamstats} (void)
\item 
double $\ast$ \hyperlink{lsa_8c_a96e2c37e58948ed0de40f3a214ca2c9a}{GetTimes} (void)
\item 
void \hyperlink{lsa_8c_a767f7f6771bbc70aa83ac12af17c4504}{SetOutname} (char $\ast$outname)
\item 
void \hyperlink{lsa_8c_a9980c5df8e4bcab0280121ff628e0a90}{RestoreLamstats} (double $\ast$stats)
\item 
void \hyperlink{lsa_8c_a1a48e7d336940bbe4a41bd20405a6fc5}{RestoreTimes} (double $\ast$delta)
\item 
void \hyperlink{lsa_8c_a02d325f210ffdd19fec3a4f97f5b81d9}{RestoreLog} (void)
\item 
void \hyperlink{lsa_8c_af2626ed486292b9cf0a251e7081c5c7d}{WriteLandscape} (char $\ast$landfile, int iteration, double delta\_\-energy)
\item 
void \hyperlink{lsa_8c_a910ffcd2147f517747e6f5274f75e377}{WriteLog} (void)
\item 
void \hyperlink{lsa_8c_ab9e433e1288e54e255cd1bd7dd4edbc5}{PrintLog} (FILE $\ast$outptr, int local\_\-flag)
\item 
\hyperlink{structSAType}{SAType} \hyperlink{lsa_8c_ac50463d97ec33a892dd4a90929dbd1f1}{InitDefaultSA} ()
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hypertarget{lsa_8c_a68959362eba4578ce1f494986dd52862}{
\hyperlink{structmy__distrib}{DistParms} {\bfseries distp}}
\label{lsa_8c_a68959362eba4578ce1f494986dd52862}

\item 
\hypertarget{lsa_8c_a9a7037ec35061cc6a01009c8a48faf45}{
int {\bfseries prolix}}
\label{lsa_8c_a9a7037ec35061cc6a01009c8a48faf45}

\item 
\hypertarget{lsa_8c_a5d2dff1fd64105fe4e6e3917439bd6a5}{
\hyperlink{structScoreOutput}{ScoreOutput} {\bfseries out}}
\label{lsa_8c_a5d2dff1fd64105fe4e6e3917439bd6a5}

\item 
const int \hyperlink{lsa_8c_ab8b764097b0f861ad9adc095a88e6edb}{MAX\_\-PRECISION} = 16
\item 
const double \hyperlink{lsa_8c_a634312c07b9e2c66592be1878b5a6564}{FORBIDDEN\_\-MOVE} = DBL\_\-MAX
\item 
const int \hyperlink{lsa_8c_ac0856e3e4744f90264ff7477676c2e7b}{OUT\_\-OF\_\-BOUND} = -\/1
\item 
\hypertarget{lsa_8c_a477085dedf21d4d933faec815ecdf78e}{
const int {\bfseries MIN\_\-DELTA} = -\/100}
\label{lsa_8c_a477085dedf21d4d933faec815ecdf78e}

\end{DoxyCompactItemize}


\subsection{Detailed Description}
Credits:

Originally written by Jimmy Lam and Dan Greening Adaptation for continuous problems and original implemen-\/ tation of the parallel algorithm by John Reinitz Tuning, equilibration and quenchit mode by King-\/Wai Chu Partly rewritten, extended \& documented by Johannes Jaeger

see ../doc/prog\_\-man.ps for details of how this works

IMPORTANT: IF YOU EVER CHANGE ANYTHING IN THIS FILE, LET ALL YOUR FELLOW PROGRAMMERS KNOW WELL IN ADVANCE AND CONSULT WITH THEM IF THEY AGREE ON YOUR CHANGES!!

Copyright (C) 1989-\/2003 John Reinitz

This program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-\/1307, U.S.A. 

\subsection{Function Documentation}
\hypertarget{lsa_8c_ae56852702f23eab04eecd25bf09406e5}{
\index{lsa.c@{lsa.c}!FixTLoop@{FixTLoop}}
\index{FixTLoop@{FixTLoop}!lsa.c@{lsa.c}}
\subsubsection[{FixTLoop}]{\setlength{\rightskip}{0pt plus 5cm}void FixTLoop (void)}}
\label{lsa_8c_ae56852702f23eab04eecd25bf09406e5}
FixTLoop: loops (making moves, updating stats etc.) keeping the temp-\/ erature fixed for an equilibration run \hypertarget{lsa_8c_af1f7f727fc1eb8fadaf6771b9c16e977}{
\index{lsa.c@{lsa.c}!Frozen@{Frozen}}
\index{Frozen@{Frozen}!lsa.c@{lsa.c}}
\subsubsection[{Frozen}]{\setlength{\rightskip}{0pt plus 5cm}int Frozen (void)}}
\label{lsa_8c_af1f7f727fc1eb8fadaf6771b9c16e977}
Frozen: returns TRUE if frozen, FALSE otherwise; 'frozen' is defined by 'freeze\_\-count', 'stop\_\-flag' and 'criterion' (see also \hyperlink{sa_8h}{sa.h} for a more extensive comment on this) \hypertarget{lsa_8c_afcd9faeb0e89612337adc262aa8ada76}{
\index{lsa.c@{lsa.c}!GetEquil@{GetEquil}}
\index{GetEquil@{GetEquil}!lsa.c@{lsa.c}}
\subsubsection[{GetEquil}]{\setlength{\rightskip}{0pt plus 5cm}void GetEquil (double $\ast$ {\em equil\_\-var})}}
\label{lsa_8c_afcd9faeb0e89612337adc262aa8ada76}
GetEquil: returns the results of an equilibration run \hypertarget{lsa_8c_a97015221283e0ba21a0678b889fa9d85}{
\index{lsa.c@{lsa.c}!GetLamstats@{GetLamstats}}
\index{GetLamstats@{GetLamstats}!lsa.c@{lsa.c}}
\subsubsection[{GetLamstats}]{\setlength{\rightskip}{0pt plus 5cm}double$\ast$ GetLamstats (void)}}
\label{lsa_8c_a97015221283e0ba21a0678b889fa9d85}
GetLamstats: returns Lam statistics in an array of doubles; used to store Lam statistics in a state file \hypertarget{lsa_8c_a96e2c37e58948ed0de40f3a214ca2c9a}{
\index{lsa.c@{lsa.c}!GetTimes@{GetTimes}}
\index{GetTimes@{GetTimes}!lsa.c@{lsa.c}}
\subsubsection[{GetTimes}]{\setlength{\rightskip}{0pt plus 5cm}double$\ast$ GetTimes (void)}}
\label{lsa_8c_a96e2c37e58948ed0de40f3a214ca2c9a}
GetTimes: returns a two-\/element array with the current wallclock and user time to be saved in the state file; for parallel code we average the times for all processes \hypertarget{lsa_8c_ac50463d97ec33a892dd4a90929dbd1f1}{
\index{lsa.c@{lsa.c}!InitDefaultSA@{InitDefaultSA}}
\index{InitDefaultSA@{InitDefaultSA}!lsa.c@{lsa.c}}
\subsubsection[{InitDefaultSA}]{\setlength{\rightskip}{0pt plus 5cm}{\bf SAType} InitDefaultSA ()}}
\label{lsa_8c_ac50463d97ec33a892dd4a90929dbd1f1}
default simulated annealing algorithm params \hypertarget{lsa_8c_a29ace73bf86acc89685ac790663260be}{
\index{lsa.c@{lsa.c}!InitFilenames@{InitFilenames}}
\index{InitFilenames@{InitFilenames}!lsa.c@{lsa.c}}
\subsubsection[{InitFilenames}]{\setlength{\rightskip}{0pt plus 5cm}void InitFilenames ({\bf Files} $\ast$ {\em files})}}
\label{lsa_8c_a29ace73bf86acc89685ac790663260be}
InitFilenames: initializes static file names that depend on the out-\/ put file name (i.e. this $\ast$must$\ast$ be called after we have called \hyperlink{fly__sa_8c_a4cdbbbb8ebb7753c6132f6a3218a2ac1}{RestoreState()}) \hypertarget{lsa_8c_a98f8ef9313691be2823b678050cf41ae}{
\index{lsa.c@{lsa.c}!Initialize@{Initialize}}
\index{Initialize@{Initialize}!lsa.c@{lsa.c}}
\subsubsection[{Initialize}]{\setlength{\rightskip}{0pt plus 5cm}void Initialize (int {\em argc}, \/  char $\ast$$\ast$ {\em argv})}}
\label{lsa_8c_a98f8ef9313691be2823b678050cf41ae}
Initialize: calls ParseCommandLine first; then does either initial randomization and collecting Lam stats or restores state of the annealer as saved in the state file \hypertarget{lsa_8c_ae10c4c8f9a418b3936a83312162c8894}{
\index{lsa.c@{lsa.c}!InitializeParameter@{InitializeParameter}}
\index{InitializeParameter@{InitializeParameter}!lsa.c@{lsa.c}}
\subsubsection[{InitializeParameter}]{\setlength{\rightskip}{0pt plus 5cm}void InitializeParameter (void)}}
\label{lsa_8c_ae10c4c8f9a418b3936a83312162c8894}
InitializeParameter: initializes variables for Lam annealing: this is executed after doing the initial steps; the local parameters only need to be set for tu-\/ ning code \hypertarget{lsa_8c_a9c04d1f899ab7d94678c92af91aa5d8e}{
\index{lsa.c@{lsa.c}!InitializeWeights@{InitializeWeights}}
\index{InitializeWeights@{InitializeWeights}!lsa.c@{lsa.c}}
\subsubsection[{InitializeWeights}]{\setlength{\rightskip}{0pt plus 5cm}void InitializeWeights (void)}}
\label{lsa_8c_a9c04d1f899ab7d94678c92af91aa5d8e}
InitializeWeights: initialize weights a and b for calculating Lam estimators; these weights are computed from the lambda memory length products \hypertarget{lsa_8c_ac7b75e6e07185445d2cca5b3531c82b1}{
\index{lsa.c@{lsa.c}!InitialLoop@{InitialLoop}}
\index{InitialLoop@{InitialLoop}!lsa.c@{lsa.c}}
\subsubsection[{InitialLoop}]{\setlength{\rightskip}{0pt plus 5cm}void InitialLoop (void)}}
\label{lsa_8c_ac7b75e6e07185445d2cca5b3531c82b1}
InitialLoop: performs the two sets of initial moves: 1. randomizing moves (not parallelized) 2. loop for initial collection of statistics \hypertarget{lsa_8c_ad28f23592af10fe367b042d101d20d2c}{
\index{lsa.c@{lsa.c}!InitLandscape@{InitLandscape}}
\index{InitLandscape@{InitLandscape}!lsa.c@{lsa.c}}
\subsubsection[{InitLandscape}]{\setlength{\rightskip}{0pt plus 5cm}void InitLandscape (int {\em value}, \/  char $\ast$ {\em file})}}
\label{lsa_8c_ad28f23592af10fe367b042d101d20d2c}
InitLandscape: sets flag for printing landscape output and acceptance landscape and initializes the landscape file names called from xxx\_\-sa.c to make filenames static and set landscape flag \hypertarget{lsa_8c_a3d44ba75fca31cf103092e6b7a604dcf}{
\index{lsa.c@{lsa.c}!Loop@{Loop}}
\index{Loop@{Loop}!lsa.c@{lsa.c}}
\subsubsection[{Loop}]{\setlength{\rightskip}{0pt plus 5cm}void Loop (void)}}
\label{lsa_8c_a3d44ba75fca31cf103092e6b7a604dcf}
Loop: loops (making moves, updating stats etc.) until the system is considered frozen according to the stop criterion \hypertarget{lsa_8c_a3c04138a5bfe5d72780bb7e82a18e627}{
\index{lsa.c@{lsa.c}!main@{main}}
\index{main@{main}!lsa.c@{lsa.c}}
\subsubsection[{main}]{\setlength{\rightskip}{0pt plus 5cm}int main (int {\em argc}, \/  char $\ast$$\ast$ {\em argv})}}
\label{lsa_8c_a3c04138a5bfe5d72780bb7e82a18e627}
main function for the Simulated Annealing optimization code \hypertarget{lsa_8c_ab9e433e1288e54e255cd1bd7dd4edbc5}{
\index{lsa.c@{lsa.c}!PrintLog@{PrintLog}}
\index{PrintLog@{PrintLog}!lsa.c@{lsa.c}}
\subsubsection[{PrintLog}]{\setlength{\rightskip}{0pt plus 5cm}void PrintLog (FILE $\ast$ {\em outptr}, \/  int {\em local\_\-flag})}}
\label{lsa_8c_ab9e433e1288e54e255cd1bd7dd4edbc5}
PrintLog: actually prints the log to wherever it needs to be printed \hypertarget{lsa_8c_a9980c5df8e4bcab0280121ff628e0a90}{
\index{lsa.c@{lsa.c}!RestoreLamstats@{RestoreLamstats}}
\index{RestoreLamstats@{RestoreLamstats}!lsa.c@{lsa.c}}
\subsubsection[{RestoreLamstats}]{\setlength{\rightskip}{0pt plus 5cm}void RestoreLamstats (double $\ast$ {\em stats})}}
\label{lsa_8c_a9980c5df8e4bcab0280121ff628e0a90}
RestoreLamstats: restores static Lam statistics in \hyperlink{lsa_8c}{lsa.c} from an array of doubles; used to restore runs from a state file. \hypertarget{lsa_8c_a02d325f210ffdd19fec3a4f97f5b81d9}{
\index{lsa.c@{lsa.c}!RestoreLog@{RestoreLog}}
\index{RestoreLog@{RestoreLog}!lsa.c@{lsa.c}}
\subsubsection[{RestoreLog}]{\setlength{\rightskip}{0pt plus 5cm}void RestoreLog (void)}}
\label{lsa_8c_a02d325f210ffdd19fec3a4f97f5b81d9}
RestoreLog: restores the .log (and the .llog files) upon restart \hypertarget{lsa_8c_a1a48e7d336940bbe4a41bd20405a6fc5}{
\index{lsa.c@{lsa.c}!RestoreTimes@{RestoreTimes}}
\index{RestoreTimes@{RestoreTimes}!lsa.c@{lsa.c}}
\subsubsection[{RestoreTimes}]{\setlength{\rightskip}{0pt plus 5cm}void RestoreTimes (double $\ast$ {\em delta})}}
\label{lsa_8c_a1a48e7d336940bbe4a41bd20405a6fc5}
RestoreTimes: restores the wallclock and user times if -\/t is used \hypertarget{lsa_8c_a58d451ed22a1cef60419ddd598695004}{
\index{lsa.c@{lsa.c}!SetEquilibrate@{SetEquilibrate}}
\index{SetEquilibrate@{SetEquilibrate}!lsa.c@{lsa.c}}
\subsubsection[{SetEquilibrate}]{\setlength{\rightskip}{0pt plus 5cm}void SetEquilibrate ({\bf ChuParam} {\em ep})}}
\label{lsa_8c_a58d451ed22a1cef60419ddd598695004}
SetEquilibrate: simply makes the equil\_\-param struct static to \hyperlink{lsa_8c}{lsa.c} \hypertarget{lsa_8c_a767f7f6771bbc70aa83ac12af17c4504}{
\index{lsa.c@{lsa.c}!SetOutname@{SetOutname}}
\index{SetOutname@{SetOutname}!lsa.c@{lsa.c}}
\subsubsection[{SetOutname}]{\setlength{\rightskip}{0pt plus 5cm}void SetOutname (char $\ast$ {\em outname})}}
\label{lsa_8c_a767f7f6771bbc70aa83ac12af17c4504}
SetOutname: sets the output filename in \hyperlink{lsa_8c}{lsa.c}; this is necessary to have the diverse .log and .ac and .mb etc files have the name of the output file if -\/w is chosen \hypertarget{lsa_8c_ab19b9c7ff28b4c66da90a3557eff33ea}{
\index{lsa.c@{lsa.c}!UpdateParameter@{UpdateParameter}}
\index{UpdateParameter@{UpdateParameter}!lsa.c@{lsa.c}}
\subsubsection[{UpdateParameter}]{\setlength{\rightskip}{0pt plus 5cm}void UpdateParameter (void)}}
\label{lsa_8c_ab19b9c7ff28b4c66da90a3557eff33ea}
UpdateParameter: update parameters A, B, D and E and the estimators for mean and standard deviation for the current S \hypertarget{lsa_8c_afa56aa04d2b65406905685c3a86c37d9}{
\index{lsa.c@{lsa.c}!UpdateS@{UpdateS}}
\index{UpdateS@{UpdateS}!lsa.c@{lsa.c}}
\subsubsection[{UpdateS}]{\setlength{\rightskip}{0pt plus 5cm}void UpdateS (void)}}
\label{lsa_8c_afa56aa04d2b65406905685c3a86c37d9}
UpdateS: update inverse temperature S at every Sskip step \hypertarget{lsa_8c_a6fbfe227a3d23a2cc0fde42be52e9dd1}{
\index{lsa.c@{lsa.c}!UpdateStats@{UpdateStats}}
\index{UpdateStats@{UpdateStats}!lsa.c@{lsa.c}}
\subsubsection[{UpdateStats}]{\setlength{\rightskip}{0pt plus 5cm}void UpdateStats (int {\em i})}}
\label{lsa_8c_a6fbfe227a3d23a2cc0fde42be52e9dd1}
UpdateStats: updates mean, variance and acc\_\-ratio after tau moves it needs i to do sanity check in parallel code \hypertarget{lsa_8c_af2626ed486292b9cf0a251e7081c5c7d}{
\index{lsa.c@{lsa.c}!WriteLandscape@{WriteLandscape}}
\index{WriteLandscape@{WriteLandscape}!lsa.c@{lsa.c}}
\subsubsection[{WriteLandscape}]{\setlength{\rightskip}{0pt plus 5cm}void WriteLandscape (char $\ast$ {\em landfile}, \/  int {\em iteration}, \/  double {\em delta\_\-energy})}}
\label{lsa_8c_af2626ed486292b9cf0a251e7081c5c7d}
WriteLandscape: write iterations, temperature, dS/S, energy, delta\_\-energy, mean, std deviation, estimate\_\-mean, estimate\_\-sd, acceptance ratio to look at the landscape of the problem Will be either the entire landscape or only the accepted landscape \hypertarget{lsa_8c_a910ffcd2147f517747e6f5274f75e377}{
\index{lsa.c@{lsa.c}!WriteLog@{WriteLog}}
\index{WriteLog@{WriteLog}!lsa.c@{lsa.c}}
\subsubsection[{WriteLog}]{\setlength{\rightskip}{0pt plus 5cm}void WriteLog (void)}}
\label{lsa_8c_a910ffcd2147f517747e6f5274f75e377}
WriteLog: writes things like mean and variation, Lam estimators, dS, alpha and acceptance ratio to the log files and to stdout (if -\/l is chosen). 

\subsection{Variable Documentation}
\hypertarget{lsa_8c_a634312c07b9e2c66592be1878b5a6564}{
\index{lsa.c@{lsa.c}!FORBIDDEN\_\-MOVE@{FORBIDDEN\_\-MOVE}}
\index{FORBIDDEN\_\-MOVE@{FORBIDDEN\_\-MOVE}!lsa.c@{lsa.c}}
\subsubsection[{FORBIDDEN\_\-MOVE}]{\setlength{\rightskip}{0pt plus 5cm}const double {\bf FORBIDDEN\_\-MOVE} = DBL\_\-MAX}}
\label{lsa_8c_a634312c07b9e2c66592be1878b5a6564}
the following constant as a score tells the annealer to reject a move, no matter what. It had better not be a number that could actually be a score. \hypertarget{lsa_8c_ab8b764097b0f861ad9adc095a88e6edb}{
\index{lsa.c@{lsa.c}!MAX\_\-PRECISION@{MAX\_\-PRECISION}}
\index{MAX\_\-PRECISION@{MAX\_\-PRECISION}!lsa.c@{lsa.c}}
\subsubsection[{MAX\_\-PRECISION}]{\setlength{\rightskip}{0pt plus 5cm}const int {\bf MAX\_\-PRECISION} = 16}}
\label{lsa_8c_ab8b764097b0f861ad9adc095a88e6edb}
The following defines the maximum float precision that is supported by the code. \hypertarget{lsa_8c_ac0856e3e4744f90264ff7477676c2e7b}{
\index{lsa.c@{lsa.c}!OUT\_\-OF\_\-BOUND@{OUT\_\-OF\_\-BOUND}}
\index{OUT\_\-OF\_\-BOUND@{OUT\_\-OF\_\-BOUND}!lsa.c@{lsa.c}}
\subsubsection[{OUT\_\-OF\_\-BOUND}]{\setlength{\rightskip}{0pt plus 5cm}const int {\bf OUT\_\-OF\_\-BOUND} = -\/1}}
\label{lsa_8c_ac0856e3e4744f90264ff7477676c2e7b}
out of bound control in score 